// <auto-generated />
// This file was generated by FFSourceGen.
// Do not modify this file.

#nullable enable annotations
#nullable disable warnings

namespace FishyFlip.Lexicon.App.Bsky.Feed
{
    /// <summary>
    /// SearchPostsOutput Collection.
    /// </summary>
    public class SearchPostsOutputCollection : ATObjectCollectionBase<FishyFlip.Lexicon.App.Bsky.Feed.PostView>, IAsyncEnumerable<FishyFlip.Lexicon.App.Bsky.Feed.PostView>
    {

        public SearchPostsOutputCollection(FishyFlip.ATProtocol atp, string q, string? sort = default, string? since = default, string? until = default, FishyFlip.Models.ATIdentifier? mentions = default, FishyFlip.Models.ATIdentifier? author = default, string? lang = default, string? domain = default, string? url = default, List<string>? tag = default, int? limit = 25, string? cursor = default, CancellationToken cancellationToken = default)
             : base(atp)
        {
            this.Q = q;
            this.Sort = sort;
            this.Since = since;
            this.Until = until;
            this.Mentions = mentions;
            this.Author = author;
            this.Lang = lang;
            this.Domain = domain;
            this.Url = url;
            this.Tag = tag;
            this.Limit = limit;
            this.Cursor = cursor;
            this.CancellationToken = cancellationToken;
        }

        public string Q { get; }

        public string? Sort { get; }

        public string? Since { get; }

        public string? Until { get; }

        public FishyFlip.Models.ATIdentifier? Mentions { get; }

        public FishyFlip.Models.ATIdentifier? Author { get; }

        public string? Lang { get; }

        public string? Domain { get; }

        public string? Url { get; }

        public List<string>? Tag { get; }

        /// <inheritdoc/>
        public override async Task<(IList<FishyFlip.Lexicon.App.Bsky.Feed.PostView> Posts, string Cursor)> GetRecordsAsync(int? limit = null, CancellationToken? token = default)
        {
            token = token ?? this.CancellationToken ?? System.Threading.CancellationToken.None;
            var (result, error) = await this.ATProtocol.SearchPostsAsync(q: this.Q, sort: this.Sort, since: this.Since, until: this.Until, mentions: this.Mentions, author: this.Author, lang: this.Lang, domain: this.Domain, url: this.Url, tag: this.Tag, limit: limit, cursor: this.Cursor, cancellationToken: token.Value!);

            this.HandleATError(error);

            if (result == null || result.Posts == null)
            {
                throw new InvalidOperationException("The result or its properties cannot be null.");
            }

            return (result.Posts, result.Cursor ?? string.Empty);
        }

        public static SearchPostsOutputCollection Create(FishyFlip.ATProtocol atp, string q, string? sort = default, string? since = default, string? until = default, FishyFlip.Models.ATIdentifier? mentions = default, FishyFlip.Models.ATIdentifier? author = default, string? lang = default, string? domain = default, string? url = default, List<string>? tag = default, int? limit = 25, string? cursor = default, CancellationToken cancellationToken = default)
        {
            return new(atp: atp, q: q, sort: sort, since: since, until: until, mentions: mentions, author: author, lang: lang, domain: domain, url: url, tag: tag, limit: limit, cursor: cursor, cancellationToken: cancellationToken);
        }
    }
}

